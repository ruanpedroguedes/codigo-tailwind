{% extends 'base.html' %}
{% load static %}
{% load static tailwind_tags %}
{% tailwind_css %}

{% block content %}

<div class="m-10">
    <h1 class="text-3xl font-bold">Dashboard: {{event.title}}</h1>
</div>

<div class="flex justify-center">
    <h1 class="text-3xl font-bold">Resumo de Ingressos</h1>
</div>

<form method="get" class="mb-6 flex gap-3">
    <select name="setor" class="border p-2">
      <option value="">Todos</option>
      {% for s in setores %}
        <option value="{{ s.id }}" {% if request.GET.setor == s.id|stringformat:"s" %}selected{% endif %}>{{ s.title }}</option>
      {% endfor %}
    </select>
    <button type="submit" class="bg-blue-600 text-white px-3 py-1">Filtrar</button>
</form>

<div class="flex justify-center m-10 gap-4">
  <div class="bg-blue-700 text-white w-[250px] h-48 rounded-2xl shadow-lg flex flex-col items-center justify-center hover:scale-105 transition-transform duration-200">
      <h1 class="text-lg mb-2">Ingressos Disponíveis</h1>
      <div class="text-3xl font-extrabold">{{ disponiveis }}</div>
  </div>
  <div class="bg-green-700 text-white w-[250px] h-48 rounded-2xl shadow-lg flex flex-col items-center justify-center hover:scale-105 transition-transform duration-200">
      <h1 class="text-lg mb-2">Ingressos Reservados</h1>
      <div class="text-3xl font-extrabold">{{ emitidos }}</div>
  </div>
  <div class="bg-red-600 text-white w-[250px] h-48 rounded-2xl shadow-lg flex flex-col items-center justify-center hover:scale-105 transition-transform duration-200">
      <h1 class="text-lg mb-2">Ingressos Validados</h1>
      <div class="text-3xl font-extrabold">{{ validados }}</div>
  </div>
</div>



<div class="flex justify-center gap-6 mt-10">
  <canvas id="pie" width="700" height="700"></canvas>
  <canvas id="statusPie" width="700" height="700"></canvas>
</div>


</main>



<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script>
  new Chart(pie, {
    type:'doughnut',
    data:{labels:['Disponíveis','Reservados'],datasets:[{data:[{{ percent_disponiveis }},{{ percent_emitidos }}],backgroundColor:['#0c0','#f44']}]}
  })
  new Chart(statusPie, {
    type:'doughnut',
    data:{labels:['Pendentes','Realizados'],datasets:[{data:[{{ total_pendentes }},{{ total_realizados }}],backgroundColor:['#fc4','#0a6']}]}
  })
</script>

{% endblock %}
